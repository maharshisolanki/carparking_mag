{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\mahar\\\\Desktop\\\\react_car\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\mahar\\\\Desktop\\\\react_car\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _inherits from \"C:\\\\Users\\\\mahar\\\\Desktop\\\\react_car\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:\\\\Users\\\\mahar\\\\Desktop\\\\react_car\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"C:\\\\Users\\\\mahar\\\\Desktop\\\\react_car\\\\src\\\\Components\\\\AdminComponent\\\\locationDetail.js\";\nimport React, { Component } from 'react';\nimport MuiThemeProvider from 'material-ui/styles/MuiThemeProvider';\nimport AppBar from 'material-ui/AppBar';\nimport RaisedButton from 'material-ui/RaisedButton';\nimport TextField from 'material-ui/TextField';\nimport * as firebase from 'firebase';\nimport Drawer from 'material-ui/Drawer';\nimport MenuItem from 'material-ui/MenuItem';\nimport IconButton from 'material-ui/IconButton';\nimport NavigationClose from 'material-ui/svg-icons/navigation/close';\nimport FlatButton from 'material-ui/FlatButton';\nimport Paper from 'material-ui/Paper';\nimport TimePicker from 'material-ui/TimePicker';\nimport DatePicker from 'material-ui/DatePicker';\nimport Logout from \"../logout\";\nimport { Card, CardActions, CardHeader, CardMedia, CardTitle, CardText } from 'material-ui/Card';\nimport { BrowserRouter as Router, Route, Link } from 'react-router-dom';\n\nvar LocationDetail = /*#__PURE__*/function (_Component) {\n  _inherits(LocationDetail, _Component);\n\n  var _super = _createSuper(LocationDetail);\n\n  function LocationDetail() {\n    var _this;\n\n    _classCallCheck(this, LocationDetail);\n\n    _this = _super.call(this);\n\n    _this.handleExpandChange = function (expanded) {\n      _this.setState({\n        expanded: expanded\n      });\n    };\n\n    _this.handleToggle = function (event, toggle) {\n      _this.setState({\n        expanded: toggle\n      });\n    };\n\n    _this.handleExpand = function () {\n      _this.setState({\n        expanded: true\n      });\n    };\n\n    _this.handleReduce = function () {\n      _this.setState({\n        expanded: false\n      });\n    };\n\n    var date = new Date();\n    date.setHours(0, 0, 0, 0);\n    var startTime = new Date();\n    var endTime = new Date();\n    endTime.setHours(endTime.getHours() + 1);\n    _this.state = {\n      slots: [],\n      expanded: false,\n      slotNumber: '',\n      slot_array: [],\n      location_name: [],\n      location: ' ',\n      no_of_slots: '',\n      date: date,\n      startTime: startTime,\n      endTime: endTime,\n      locationId: '',\n      BookingKey: [],\n      date_now: ''\n    };\n    return _this;\n  }\n\n  _createClass(LocationDetail, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      //  var uid = firebase.auth().currentUser.uid;\n      firebase.auth().onAuthStateChanged(function () {\n        if (firebase.auth().currentUser) {\n          var slot = [];\n          var status = \"\";\n          var slotNo = \"\";\n          var locationId = _this2.props.location.state.key;\n          var rootRef = firebase.database().ref();\n          var speedRef = rootRef.child('Locations/' + locationId);\n          speedRef.on('value', function (snap) {\n            var values = snap.val();\n            var local_array;\n            var slot;\n            var slotcount;\n\n            _this2.state.location_name.push(values.LocationName);\n\n            _this2.state.slot_array.push(values.Slot);\n\n            _this2.state.slot_array = Object.keys(values.Slot).map(function (value, index) {\n              return [value];\n            });\n\n            _this2.setState({\n              location_name: _this2.state.location_name,\n              slot_array: _this2.state.slot_array,\n              locationId: locationId\n            });\n          });\n\n          _this2.setState({\n            slots: slot\n          });\n        }\n      });\n    }\n  }, {\n    key: \"Book\",\n    value: function Book() {\n      var userId = firebase.auth().currentUser.uid;\n      var pushId = firebase.database().ref().push().key;\n      console.log(pushId);\n\n      if (undefined == null) {\n        firebase.database().ref('Booking/').push({\n          UserId: userId,\n          locationId: this.state.locationId,\n          SlotNo: String(this.state.slotNumber),\n          StartTime: String(this.state.startTime),\n          EndTime: String(this.state.endTime),\n          date: String(this.state.date)\n        });\n      }\n    }\n  }, {\n    key: \"CheckBooking\",\n    value: function CheckBooking() {\n      var _this3 = this;\n\n      var date = this.state.date;\n      var startTime = this.state.startTime;\n      startTime.setFullYear(date.getFullYear());\n      startTime.setDate(date.getDate());\n      startTime.setMonth(date.getMonth());\n      var endTime = this.state.endTime;\n      endTime.setFullYear(date.getFullYear());\n      endTime.setDate(date.getDate());\n      endTime.setMonth(date.getMonth());\n      var count = 0;\n      var dateNow = String(date.getDate()) + '-' + String(date.getMonth() + 1) + '-' + String(date.getFullYear());\n      this.setState({\n        date_now: dateNow\n      });\n      firebase.database().ref('Booking/').orderByChild('SlotNo').equalTo(String(this.state.slotNumber)).on('value', function (snap) {\n        var booked = snap.val();\n\n        if (booked) {\n          var bookings = [];\n\n          for (var a in booked) {\n            bookings.push(booked[a]);\n          }\n\n          for (var i = 0; i < bookings.length; i++) {\n            var book = bookings[i];\n            var start = new Date(book.StartTime);\n            var end = new Date(book.EndTime);\n\n            if (startTime.getTime() < start.getTime() && endTime.getTime() > start.getTime() || startTime.getTime() < end.getTime() && endTime.getTime() > end.getTime()) {\n              alert(\"Slot already booked :( try some other time\");\n            } else {\n              count = count + 1;\n            }\n          }\n        } else {\n          _this3.Book();\n\n          console.log(\"Slot has been Booked for you \");\n        }\n\n        console.log(\"count \" + count);\n      });\n\n      if (count >= 1) {\n        this.Book();\n        console.log(\"Slot has been Booked for you \");\n      }\n\n      count = 0;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(MuiThemeProvider, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(Paper, {\n        style: style,\n        zDepth: 3,\n        rounded: false,\n        id: \"abc\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 22\n        }\n      }, /*#__PURE__*/React.createElement(Card, {\n        expanded: this.state.expanded,\n        onExpandChange: this.handleExpandChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(CardText, {\n        expandable: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"h2\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 33\n        }\n      }, \" Reserved Parking Slot \", this.state.slotNumber), /*#__PURE__*/React.createElement(TimePicker, {\n        defaultTime: this.state.startTime,\n        onChange: function onChange() {\n          _this4.setState({\n            startTime: arguments.length <= 1 ? undefined : arguments[1]\n          });\n        },\n        style: {\n          display: 'inline-block'\n        },\n        floatingLabelText: \"Start Time\",\n        autoOk: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 38\n        }\n      }), /*#__PURE__*/React.createElement(TimePicker, {\n        defaultTime: this.state.endTime,\n        onChange: function onChange() {\n          _this4.setState({\n            endTime: arguments.length <= 1 ? undefined : arguments[1]\n          });\n        },\n        style: {\n          display: 'inline-block'\n        },\n        floatingLabelText: \"End Time\",\n        autoOk: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 41\n        }\n      }), /*#__PURE__*/React.createElement(DatePicker, {\n        autoOk: true,\n        minDate: new Date(),\n        defaultDate: this.state.date,\n        onChange: function onChange() {\n          _this4.setState({\n            date: arguments.length <= 1 ? undefined : arguments[1]\n          });\n        },\n        style: {\n          display: 'inline-block'\n        },\n        floatingLabelText: \"Select Date\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 41\n        }\n      }), /*#__PURE__*/React.createElement(RaisedButton, {\n        label: \"Book later\",\n        onTouchTap: this.handleReduce,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 28\n        }\n      }), /*#__PURE__*/React.createElement(RaisedButton, {\n        label: \"Book\",\n        primary: true,\n        onClick: function onClick(event) {\n          return _this4.CheckBooking(event);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 27\n        }\n      }))), this.state.slot_array.map(function (item, index) {\n        return /*#__PURE__*/React.createElement(\"span\", {\n          __self: _this4,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 24\n          }\n        }, /*#__PURE__*/React.createElement(RaisedButton, {\n          label: \"Slot \" + item,\n          primary: true,\n          onTouchTap: function onTouchTap() {\n            _this4.setState({\n              slotNumber: item\n            });\n\n            _this4.handleExpand();\n          },\n          __self: _this4,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 33\n          }\n        }));\n      })))));\n    }\n  }]);\n\n  return LocationDetail;\n}(Component);\n\nexport { LocationDetail as default };\nvar style = {\n  width: 1000,\n  margin: 5,\n  display: 'inline'\n};","map":{"version":3,"sources":["C:/Users/mahar/Desktop/react_car/src/Components/AdminComponent/locationDetail.js"],"names":["React","Component","MuiThemeProvider","AppBar","RaisedButton","TextField","firebase","Drawer","MenuItem","IconButton","NavigationClose","FlatButton","Paper","TimePicker","DatePicker","Logout","Card","CardActions","CardHeader","CardMedia","CardTitle","CardText","BrowserRouter","Router","Route","Link","LocationDetail","handleExpandChange","expanded","setState","handleToggle","event","toggle","handleExpand","handleReduce","date","Date","setHours","startTime","endTime","getHours","state","slots","slotNumber","slot_array","location_name","location","no_of_slots","locationId","BookingKey","date_now","auth","onAuthStateChanged","currentUser","slot","status","slotNo","props","key","rootRef","database","ref","speedRef","child","on","snap","values","val","local_array","slotcount","push","LocationName","Slot","Object","keys","map","value","index","userId","uid","pushId","console","log","undefined","UserId","SlotNo","String","StartTime","EndTime","setFullYear","getFullYear","setDate","getDate","setMonth","getMonth","count","dateNow","orderByChild","equalTo","booked","bookings","a","i","length","book","start","end","getTime","alert","Book","style","display","CheckBooking","item","width","margin"],"mappings":"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","sourcesContent":["import React,{Component} from 'react'\r\nimport MuiThemeProvider from 'material-ui/styles/MuiThemeProvider';\r\nimport AppBar from 'material-ui/AppBar';\r\nimport RaisedButton from 'material-ui/RaisedButton';\r\nimport TextField from 'material-ui/TextField';\r\nimport * as firebase from 'firebase'; \r\nimport Drawer from 'material-ui/Drawer';\r\nimport MenuItem from 'material-ui/MenuItem';\r\nimport IconButton from 'material-ui/IconButton';\r\nimport NavigationClose from 'material-ui/svg-icons/navigation/close';\r\nimport FlatButton from 'material-ui/FlatButton';\r\nimport Paper from 'material-ui/Paper';\r\nimport TimePicker from 'material-ui/TimePicker';\r\nimport DatePicker from 'material-ui/DatePicker';\r\nimport Logout from \"../logout\"\r\nimport {Card, CardActions, CardHeader, CardMedia, CardTitle, CardText} from 'material-ui/Card';\r\nimport{\r\nBrowserRouter as Router,\r\nRoute,\r\nLink\r\n}from 'react-router-dom';\r\nexport default class LocationDetail extends Component{\r\nconstructor(){\r\n    super()\r\n     var date = new Date();\r\n        date.setHours(0,0,0,0)\r\n        var startTime = new Date();\r\n        var endTime = new Date(); \r\n        endTime.setHours((endTime.getHours()+1)) \r\n    this.state={\r\n        slots:[],\r\n        expanded: false,\r\n        slotNumber:'',\r\n        slot_array:[],\r\n        location_name:[],\r\n        location:' ',\r\n        no_of_slots:'',\r\n         date,\r\n         startTime,\r\n         endTime,\r\n         locationId:'',\r\n         BookingKey:[],\r\n         date_now:''\r\n    }\r\n}\r\n\r\n\r\nhandleExpandChange = (expanded) => {\r\n    this.setState({expanded: expanded});\r\n  };\r\n\r\n  handleToggle = (event, toggle) => {\r\n    this.setState({expanded: toggle});\r\n  };\r\n\r\n  handleExpand = () => {\r\n    this.setState({expanded: true});\r\n  };\r\n\r\n  handleReduce = () => {\r\n    this.setState({expanded: false});\r\n  };\r\ncomponentDidMount(){\r\n    //  var uid = firebase.auth().currentUser.uid;\r\n          \r\n  firebase.auth().onAuthStateChanged(() => {\r\n    if(firebase.auth().currentUser){\r\n     var slot=[];\r\n     var status=\"\";\r\n     var slotNo=\"\";\r\n     var locationId=this.props.location.state.key\r\n     const rootRef= firebase.database().ref();\r\n    const speedRef = rootRef.child('Locations/'+ locationId);\r\n    speedRef.on('value',snap => {\r\n    var values=snap.val();\r\n    var local_array;\r\n     var slot;\r\n     var slotcount;\r\n  \r\n           this.state.location_name.push(values.LocationName)\r\n           this.state.slot_array.push(values.Slot)\r\n           this.state.slot_array= Object.keys(values.Slot).map(function (value,index) \r\n          {\r\n             return [value];\r\n          });          \r\n          \r\n     \r\n      this.setState({\r\n       location_name:this.state.location_name,\r\n       slot_array:this.state.slot_array,\r\n       locationId:locationId\r\n      })\r\n \r\n   })\r\n      this.setState({\r\n        slots:slot\r\n     })\r\n    }\r\n  })\r\n}\r\nBook(){\r\n   var userId=firebase.auth().currentUser.uid;\r\n  var pushId=firebase.database().ref().push().key;\r\n  console.log(pushId)\r\n  if(undefined==null){\r\n           firebase.database().ref('Booking/').push({\r\n            UserId:userId,\r\n            locationId:this.state.locationId,\r\n            SlotNo:String(this.state.slotNumber),\r\n            StartTime:String(this.state.startTime),\r\n            EndTime:String(this.state.endTime),\r\n            date:String(this.state.date)\r\n \r\n          })\r\n\r\n      }        \r\n\r\n\r\n\r\n}\r\n\r\n\r\n CheckBooking(){\r\n\r\n   var date = this.state.date;\r\n    var startTime = this.state.startTime;\r\n    startTime.setFullYear(date.getFullYear());\r\n    startTime.setDate(date.getDate());\r\n    startTime.setMonth(date.getMonth());\r\n    var endTime = this.state.endTime;\r\n    endTime.setFullYear(date.getFullYear());\r\n    endTime.setDate(date.getDate());\r\n    endTime.setMonth(date.getMonth());\r\n    var count=0;\r\n    var dateNow = String(date.getDate())+'-'+String(date.getMonth()+1)+'-'+String(date.getFullYear())\r\n    this.setState({date_now: dateNow})\r\n    firebase.database().ref('Booking/').orderByChild('SlotNo').equalTo(String(this.state.slotNumber)).on('value',snap => {\r\n      const booked = snap.val();\r\n \r\n      if(booked){\r\n        \r\n        let bookings = []\r\n        for(let a in booked){\r\n          bookings.push(booked[a])\r\n        \r\n        }\r\n   \r\n          for(let i=0; i< bookings.length ; i++){\r\n\r\n            let book = bookings[i];\r\n            let start = new Date(book.StartTime);\r\n            let end = new Date(book.EndTime);\r\n\r\n            if(((startTime.getTime() < start.getTime()) && (endTime.getTime() > start.getTime())) || ((startTime.getTime() < end.getTime()) && (endTime.getTime() > end.getTime()))){\r\n              alert(\"Slot already booked :( try some other time\" )              \r\n            }\r\n            else{\r\n              count = count +1;\r\n            }\r\n          }\r\n      \r\n      }\r\n\r\n       else{\r\n        this.Book()\r\n          console.log(\"Slot has been Booked for you \")\r\n      }\r\n        console.log(\"count \"+count)\r\n   \r\n   })\r\n    if (count >= 1){\r\n       this.Book()\r\n         console.log(\"Slot has been Booked for you \")\r\n      }\r\ncount=0;\r\n\r\n    }\r\n\r\nrender(){\r\n    return(\r\n            <div>           \r\n             \r\n              <MuiThemeProvider>\r\n                  <div>\r\n                     <Paper style={style} zDepth={3} rounded={false} id=\"abc\" >\r\n                        <Card expanded={this.state.expanded} onExpandChange={this.handleExpandChange}>\r\n                            <CardText expandable={true}>\r\n                                <h2> Reserved Parking Slot {this.state.slotNumber}</h2>\r\n\r\n                                     <TimePicker defaultTime={this.state.startTime}\r\n                                        onChange={(...arg) => {this.setState({startTime: arg[1]})}\r\n                                        }  \r\n                                          style={{display: 'inline-block'}}\r\n                                          floatingLabelText=\"Start Time\" \r\n                                          autoOk={true}/>\r\n                               \r\n                                        <TimePicker defaultTime={this.state.endTime} \r\n                                        onChange={(...arg) => {this.setState({endTime: arg[1]})}}\r\n                                        style={{display: 'inline-block'}} \r\n                                        floatingLabelText=\"End Time\" \r\n                                        autoOk={true}/>\r\n                                          {/*<p>{this.state.endTime}</p>*/}\r\n                                        <DatePicker autoOk={true} \r\n                                        minDate={new Date()} \r\n                                        defaultDate={this.state.date}\r\n                                        onChange={(...arg) => {this.setState({date: arg[1]})}} \r\n                                        style={{display: 'inline-block'}} \r\n                                        floatingLabelText=\"Select Date\" />\r\n                                                          \r\n                           <RaisedButton label=\"Book later\" onTouchTap={this.handleReduce} />\r\n                          <RaisedButton label=\"Book\" primary={true} \r\n                          onClick={(event) => this.CheckBooking(event)}/>\r\n                                  \r\n                        </CardText>\r\n                      \r\n                         </Card>\r\n                     \r\n                     { this.state.slot_array.map((item, index) => (\r\n                       <span>\r\n                                <RaisedButton label=  {\"Slot \"+item} primary={true} onTouchTap = {() => {\r\n                                    this.setState({slotNumber:item})\r\n                                    this.handleExpand()}} />\r\n                       </span>\r\n                     ))}    \r\n                            </Paper>\r\n       \r\n                </div>\r\n            </MuiThemeProvider>\r\n         </div>\r\n  \r\n  )}\r\n}\r\nconst style = {\r\n  width:1000,\r\n  margin:5,\r\n  display: 'inline',\r\n   \r\n};\r\n\r\n"]},"metadata":{},"sourceType":"module"}